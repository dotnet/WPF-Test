<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
    <Canvas>

    <!-- SECTION 1: Use a VisualBrush as a Background for Items Controls -->

    <!-- ListBoxItem: Use VisualBrush in ListBoxItem.Background, ListBoxItem.Foreground and ListBoxItem.BorderBrush -->
    <ListBox Canvas.Top="10" Canvas.Left="10" BorderThickness="5">
        <ListBoxItem BorderThickness="2">
            LISTBOXITEM 1

            <ListBoxItem.Background>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Beige" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ListBoxItem.Background>
            <ListBoxItem.Foreground>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Blue" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ListBoxItem.Foreground>
            <ListBoxItem.BorderBrush>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Red" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ListBoxItem.BorderBrush>
         </ListBoxItem>
         <ListBoxItem>LISTBOXITEM 2</ListBoxItem>
         <ListBoxItem>LISTBOXITEM 3</ListBoxItem>
         <ListBoxItem>LISTBOXITEM 4</ListBoxItem>
         <ListBoxItem>LISTBOXITEM 5</ListBoxItem>
         <ListBoxItem>LISTBOXITEM 6</ListBoxItem>
         <ListBoxItem>LISTBOXITEM 7</ListBoxItem>
    </ListBox>

    <!-- ComboBoxItem: Use VisualBrush in ComboBoxItem.Background, ComboBoxItem.Foreground and ComboBoxItem.BorderBrush -->
    <ComboBox Canvas.Top="10" Canvas.Left="130" IsDropDownOpen="False" BorderThickness="5" Background="Gray">
        <ComboBoxItem BorderThickness="2">
            ComboBoxItem 1

            <ComboBoxItem.Background>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Beige" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ComboBoxItem.Background>
            <ComboBoxItem.Foreground>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Blue" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ComboBoxItem.Foreground>
            <ComboBoxItem.BorderBrush>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Red" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </ComboBoxItem.BorderBrush>
         </ComboBoxItem>
         <ComboBoxItem>COMBOBOXITEM 2</ComboBoxItem>
         <ComboBoxItem>COMBOBOXITEM 3</ComboBoxItem>
    </ComboBox>

    <!-- MenuItem: Use VisualBrush in MenuItem.Background, MenuItem.Foreground and MenuItem.BorderBrush -->
    <Menu Canvas.Top="10" Canvas.Left="330" BorderThickness="5" Background="Gray">
        <MenuItem BorderThickness="2" Header="MENUITEM 1">
            <MenuItem.Background>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Beige" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </MenuItem.Background>
            <MenuItem.Foreground>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Blue" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </MenuItem.Foreground>
            <MenuItem.BorderBrush>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Red" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </MenuItem.BorderBrush>
         </MenuItem>
      <Separator />
      <MenuItem Header="MENUITEM 2" />
    </Menu>

    <!-- TabItem: Use VisualBrush in TabItem.Background, TabItem.Foreground and TabItem.BorderBrush -->
    <TabControl Canvas.Top="60" Canvas.Left="130" BorderThickness="5" Background="Gray">
        <TabItem BorderThickness="2" Header="TABITEM 1">        
            <TabItem.Background>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Beige" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </TabItem.Background>
            <TabItem.Foreground>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Blue" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </TabItem.Foreground>
            <TabItem.BorderBrush>
                <VisualBrush>
	            <VisualBrush.Visual>
	                <Canvas Width="50" Height="50" Background="Red" /> 
 	            </VisualBrush.Visual>
                </VisualBrush>
            </TabItem.BorderBrush>
        </TabItem>

        <TabItem Header="TABITEM 2" />
    </TabControl>

    <!-- SECTION 2: Use Items Controls in a VisualBrush -->

    <!-- ListBox: Use ListBox and ListBoxItem in a VisualBrush -->
    <Rectangle Canvas.Top="220" Canvas.Left="10" Width="120" Height="150" Stroke="Red" StrokeThickness="2">
        <Rectangle.Fill>
            <VisualBrush AlignmentX="Left" AlignmentY="Top">
	        <VisualBrush.Visual>
                    <ListBox BorderThickness="5">
                        <ListBoxItem>LISTBOXITEM 1</ListBoxItem>
                        <ListBoxItem>LISTBOXITEM 2</ListBoxItem>
                        <ListBoxItem>LISTBOXITEM 3</ListBoxItem>
                    </ListBox>
 	        </VisualBrush.Visual>
            </VisualBrush>
        </Rectangle.Fill>
    </Rectangle> 

    <!-- ComboBox: Use ComboBox and ComboBoxItem in a VisualBrush -->
    <Rectangle Canvas.Top="220" Canvas.Left="150" Width="200" Height="150" Stroke="Red" StrokeThickness="2">
        <Rectangle.Fill>
            <VisualBrush AlignmentX="Left" AlignmentY="Top">
	        <VisualBrush.Visual>
                    <ComboBox BorderThickness="5" IsDropDownOpen="False">
                        <ComboBoxItem>COMBOBOXITEM 1</ComboBoxItem>
                        <ComboBoxItem>COMBOBOXITEM 2</ComboBoxItem>
                        <ComboBoxItem>COMBOBOXITEM 3</ComboBoxItem>
                    </ComboBox>
 	        </VisualBrush.Visual>
            </VisualBrush>
        </Rectangle.Fill>
    </Rectangle> 

    <!-- Menu: Use Menu and MenuItem in a VisualBrush -->
    <Rectangle Canvas.Top="220" Canvas.Left="370" Width="200" Height="50" Stroke="Red" StrokeThickness="2">
        <Rectangle.Fill>
            <VisualBrush AlignmentX="Left" AlignmentY="Top">
	        <VisualBrush.Visual>
                    <Menu BorderThickness="5" Background="Gray">
                        <MenuItem Header="MENUITEM 1" />
                      <Separator />
                      <MenuItem Header="MENUITEM 2" />
                    </Menu>
 	        </VisualBrush.Visual>
            </VisualBrush>
        </Rectangle.Fill>
    </Rectangle> 

    <!-- TabControl: Use TabControl and TabItem in a VisualBrush -->
    <Rectangle Canvas.Top="280" Canvas.Left="370" Width="200" Height="50" Stroke="Red" StrokeThickness="2">
        <Rectangle.Fill>
            <VisualBrush AlignmentX="Left" AlignmentY="Top">
	        <VisualBrush.Visual>
                    <TabControl BorderThickness="5" Background="Gray">
                        <TabItem Header="TABITEM 1" />
                        <TabItem Header="TABITEM 2" />
                    </TabControl>
 	        </VisualBrush.Visual>
            </VisualBrush>
        </Rectangle.Fill>
    </Rectangle> 

    </Canvas>
</Page>
